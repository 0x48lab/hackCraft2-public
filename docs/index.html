<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- キャッシュ制御を強化 -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <!-- 自動更新 -->
    <meta http-equiv="refresh" content="300">
    <title>hackCraft2 - Minecraft Modding Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <style>
        .hero {
            background-color: #2c3e50;
            color: white;
            padding: 4rem 0;
            margin-bottom: 2rem;
        }
        .feature-card {
            margin-bottom: 2rem;
            transition: transform 0.3s;
        }
        .feature-card:hover {
            transform: translateY(-5px);
        }
        .download-section {
            background-color: #f8f9fa;
            padding: 3rem 0;
            margin: 2rem 0;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#">hackCraft2</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#features">機能</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#download">ダウンロード</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#getting-started">始め方</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="visual-programming.html">ビジュアルプログラミング</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="3d-view.html">3Dビュー</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="code-editor.html">コードエディタ</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="hero">
        <div class="container text-center">
            <h1 class="display-4">hackCraft2</h1>
            <p class="lead">Minecraftの新しいModdingプラットフォーム</p>
        </div>
    </div>

    <div class="container">
        <section id="features" class="mb-5">
            <h2 class="text-center mb-4">主な機能</h2>
            <div class="row">
                <div class="col-md-4">
                    <div class="card feature-card">
                        <div class="card-body">
                            <h5 class="card-title">ビジュアルプログラミング</h5>
                            <p class="card-text">Scratch3ベースの拡張エクステンションで、Minecraftの動物をプログラミングで操作できます。</p>
                            <a href="visual-programming.html" class="btn btn-primary">
                                <i class="bi bi-arrow-right"></i> 詳細を見る
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card feature-card">
                        <div class="card-body">
                            <h5 class="card-title">3Dプレビュー</h5>
                            <p class="card-text">作成したModの3Dモデルをリアルタイムでプレビューできます。</p>
                            <a href="3d-view.html" class="btn btn-primary">
                                <i class="bi bi-arrow-right"></i> 詳細を見る
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card feature-card">
                        <div class="card-body">
                            <h5 class="card-title">コードエディタ</h5>
                            <p class="card-text">高度な機能が必要な場合は、コードエディタで直接プログラミングも可能です。</p>
                            <a href="code-editor.html" class="btn btn-primary">
                                <i class="bi bi-arrow-right"></i> 詳細を見る
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="download" class="download-section">
            <div class="container">
                <h2 class="text-center mb-4">ダウンロード</h2>
                <div class="row justify-content-center">
                    <div class="col-md-6 mb-4">
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title">
                                    <i class="bi bi-lightning-charge"></i> 最新ビルド
                                </h5>
                                <p class="card-text">最新の開発ビルドをダウンロードできます。最新の機能や修正が含まれていますが、安定性は保証されません。</p>
                                <div id="latest-build">
                                    <p class="text-muted">ビルド情報を読み込み中...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title">
                                    <i class="bi bi-tags"></i> 安定版リリース
                                </h5>
                                <p class="card-text">タグ付きの安定版リリースをダウンロードできます。テスト済みで安定した動作が期待できるバージョンです。</p>
                                <div id="stable-release">
                                    <p class="text-muted">リリース情報を読み込み中...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">
                                    <i class="bi bi-clock-history"></i> 過去のリリース
                                </h5>
                                <div id="release-history">
                                    <p class="text-muted">リリース履歴を読み込み中...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="getting-started" class="mb-5">
            <h2 class="text-center mb-4">始め方</h2>
            <div class="row">
                <div class="col-md-12 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h3 class="card-title">
                                <i class="bi bi-server"></i> サーバーセットアップ手順
                            </h3>
                            <div class="alert alert-info">
                                <i class="bi bi-info-circle"></i> この手順では、Paperサーバーを使用することを推奨しています。
                                Paperは高性能で安定したサーバーソフトウェアです。
                            </div>
                            <div class="steps">
                                <h4 class="mt-4">1. Paperサーバーのダウンロードとインストール</h4>
                                <ol>
                                    <li>
                                        <a href="https://papermc.io/downloads" target="_blank">Paperのダウンロードページ</a>から最新版のPaperをダウンロード
                                        <ul>
                                            <li>推奨バージョン: Minecraft 1.24.5</li>
                                            <li>ダウンロードしたjarファイルを任意のディレクトリに配置</li>
                                        </ul>
                                    </li>
                                    <li>
                                        サーバーの初期起動とEULAの同意
                                        <ul>
                                            <li><strong>コマンドラインでの実行を推奨:</strong></li>
                                            <li><strong>Windows (CMD):</strong> <code>java -jar paper-1.24.5-xxx.jar</code></li>
                                            <li><strong>Linux/macOS (Shell):</strong> <code>java -jar paper-1.24.5-xxx.jar</code></li>
                                            <li>初回起動時に<code>eula.txt</code>ファイルが生成されます</li>
                                            <li><code>eula.txt</code>を開き、<code>eula=false</code>を<code>eula=true</code>に変更してください</li>
                                            <li>この変更により、MinecraftのEULA（エンドユーザーライセンス契約）に同意したことになります</li>
                                        </ul>
                                    </li>
                                    <li>
                                        サーバー設定の調整（必要に応じて）
                                        <ul>
                                            <li><code>server.properties</code>ファイルでサーバー設定を調整</li>
                                            <li>開発時は<code>online-mode=false</code>に設定することを推奨</li>
                                        </ul>
                                    </li>
                                </ol>

                                <h4 class="mt-4">2. hackCraft2プラグインのインストール</h4>
                                <ol>
                                    <li>
                                        <code>plugins</code>フォルダの確認
                                        <ul>
                                            <li>Paperサーバーの初回起動時に<code>plugins</code>フォルダが自動生成されます</li>
                                            <li>フォルダが存在しない場合は、Paperサーバーのルートディレクトリに手動で作成してください</li>
                                        </ul>
                                    </li>
                                    <li>
                                        hackCraft2プラグインの配置
                                        <ul>
                                            <li>上記の「ダウンロード」セクションから安定版または最新ビルドをダウンロード</li>
                                            <li>ダウンロードしたjarファイルを<code>plugins</code>フォルダに配置</li>
                                            <li>ファイル名は<code>hackcraft2-x.xx.x-xxx-all.jar</code>のままで構いません</li>
                                        </ul>
                                    </li>
                                </ol>

                                <h4 class="mt-4">3. サーバーの起動</h4>
                                <ol>
                                    <li>
                                        <strong>コマンドラインでの起動を推奨</strong>
                                        <ul>
                                            <li><strong>Windows (CMD):</strong></li>
                                            <li><code>java -Xmx4G -Xms2G -jar paper-1.24.5-xxx.jar</code></li>
                                            <li><strong>Linux/macOS (Shell):</strong></li>
                                            <li><code>java -Xmx4G -Xms2G -jar paper-1.24.5-xxx.jar</code></li>
                                            <li><strong>Linuxでの仮想ターミナル使用例:</strong></li>
                                            <li><code>tmux new-session -d -s minecraft 'java -Xmx4G -Xms2G -jar paper-1.24.5-xxx.jar'</code></li>
                                            <li><code>tmux attach-session -t minecraft</code>（セッションに接続）</li>
                                            <li><code>Ctrl+B, D</code>（セッションから切断、バックグラウンド実行継続）</li>
                                        </ul>
                                    </li>
                                    <li>
                                        起動パラメータの説明
                                        <ul>
                                            <li><code>-Xmx4G</code>: 最大メモリ使用量を4GBに設定</li>
                                            <li><code>-Xms2G</code>: 初期メモリ使用量を2GBに設定</li>
                                            <li><code>-jar</code>: JARファイルを実行することを指定</li>
                                            <li>メモリ設定はサーバーの性能に応じて調整してください</li>
                                        </ul>
                                    </li>
                                    <li>
                                        動作確認
                                        <ul>
                                            <li>サーバーが正常に起動したら、Minecraftクライアントから接続</li>
                                            <li>サーバーコンソールで<code>/plugins</code>コマンドを実行し、hackCraft2が正常に読み込まれていることを確認</li>
                                            <li>プラグインが正常に読み込まれている場合、以下のようなメッセージが表示されます:</li>
                                            <li><code>[hackCraft2] hackCraft2 has been enabled!</code></li>
                                        </ul>
                                    </li>
                                </ol>

                                <div class="alert alert-warning mt-4">
                                    <h5><i class="bi bi-exclamation-triangle"></i> 注意事項</h5>
                                    <ul class="mb-0">
                                        <li>サーバーのメモリ割り当ては最低4GB以上を推奨（<code>-Xmx4G</code>）</li>
                                        <li>初回起動時は<code>server.properties</code>の<code>online-mode</code>を<code>false</code>に設定することを推奨（開発時）</li>
                                        <li>本番環境では適切なセキュリティ設定を行ってください</li>
                                        <li>コマンドラインでの実行により、ログの確認やサーバーの制御が容易になります</li>
                                    </ul>
                                </div>

                                <div class="alert alert-info mt-4">
                                    <h5><i class="bi bi-lightbulb"></i> トラブルシューティング</h5>
                                    <ul class="mb-0">
                                        <li>サーバーが起動しない場合は、Javaのバージョンが17以上であることを確認</li>
                                        <li>プラグインが読み込まれない場合は、jarファイルが正しい<code>plugins</code>フォルダに配置されているか確認</li>
                                        <li>エラーメッセージが表示される場合は、サーバーのログ（<code>logs/latest.log</code>）を確認</li>
                                        <li>メモリ不足の場合は、<code>-Xmx</code>パラメータを増やしてください</li>
                                        <li>Linuxでtmuxを使用する場合、<code>tmux list-sessions</code>でセッション一覧を確認できます</li>
                                    </ul>
                                </div>

                                <h4 class="mt-4">4. ローカルでのテスト</h4>
                                <div class="alert alert-success">
                                    <h5><i class="bi bi-check-circle"></i> ローカルテストの準備</h5>
                                    <p class="mb-0">開発やテスト目的でローカル環境でサーバーを実行する場合の設定手順です。</p>
                                </div>
                                <ol>
                                    <li>
                                        <strong>server.propertiesの設定</strong>
                                        <ul>
                                            <li><code>server.properties</code>ファイルを開き、以下の設定を確認・変更してください：</li>
                                            <li><code>online-mode=false</code> - オフライン環境での接続を許可</li>
                                            <li><code>server-port=25565</code> - デフォルトポート（変更可能）</li>
                                            <li><code>gamemode=creative</code> - クリエイティブモードでテスト</li>
                                            <li><code>difficulty=peaceful</code> - ピースフルモードで安全にテスト</li>
                                            <li><code>spawn-protection=0</code> - スポーン保護を無効化</li>
                                        </ul>
                                    </li>
                                    <li>
                                        <strong>ローカルネットワークでの接続</strong>
                                        <ul>
                                            <li><strong>同一PCでの接続:</strong> <code>localhost:25565</code> または <code>127.0.0.1:25565</code></li>
                                            <li><strong>同一ネットワーク内の他のPCから接続:</strong></li>
                                            <li>サーバーPCのIPアドレスを確認（Windows: <code>ipconfig</code>, Linux/macOS: <code>ifconfig</code> または <code>ip addr</code>）</li>
                                            <li>クライアント側で <code>サーバーPCのIP:25565</code> で接続</li>
                                        </ul>
                                    </li>
                                    <li>
                                        <strong>ファイアウォールの設定</strong>
                                        <ul>
                                            <li><strong>Windows:</strong> Windows Defenderファイアウォールでポート25565を許可</li>
                                            <li><strong>Linux:</strong> <code>sudo ufw allow 25565</code> または <code>sudo iptables -A INPUT -p tcp --dport 25565 -j ACCEPT</code></li>
                                            <li><strong>macOS:</strong> システム環境設定 > セキュリティとプライバシー > ファイアウォールで設定</li>
                                        </ul>
                                    </li>
                                    <li>
                                        <strong>テスト手順</strong>
                                        <ul>
                                            <li>サーバーを起動し、正常に起動することを確認</li>
                                            <li>Minecraftクライアントを起動し、サーバーに接続</li>
                                            <li>サーバーコンソールで <code>/plugins</code> を実行し、hackCraft2が読み込まれていることを確認</li>
                                            <li>ゲーム内でhackCraft2の機能をテスト</li>
                                        </ul>
                                    </li>
                                </ol>

                                <div class="alert alert-warning mt-4">
                                    <h5><i class="bi bi-exclamation-triangle"></i> ローカルテスト時の注意事項</h5>
                                    <ul class="mb-0">
                                        <li><code>online-mode=false</code>に設定している場合、Mojangアカウントでの認証は行われません</li>
                                        <li>テスト用のワールドデータは<code>world</code>フォルダに保存されます</li>
                                        <li>本番環境では必ず<code>online-mode=true</code>に設定してください</li>
                                        <li>ファイアウォールの設定は、テスト完了後に元に戻すことを推奨します</li>
                                    </ul>
                                </div>

                                <div class="alert alert-info mt-4">
                                    <h5><i class="bi bi-gear"></i> 開発者向け設定</h5>
                                    <ul class="mb-0">
                                        <li>デバッグ情報を表示するには、サーバー起動時に<code>-Ddebug=true</code>を追加</li>
                                        <li>詳細なログを確認するには、<code>logs/latest.log</code>を監視</li>
                                        <li>プラグインのリロードには<code>/reload</code>コマンドを使用（注意: 一部のデータがリセットされる場合があります）</li>
                                        <li>サーバーの停止には<code>/stop</code>コマンドを使用</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <footer class="bg-dark text-light py-4">
        <div class="container text-center">
            <p>&copy; 2024 hackCraft2. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // キャッシュを無効化してデータを取得する共通関数
        const fetchWithTimeout = (url, timeout = 5000) => {
            return Promise.race([
                fetch(url, {
                    cache: 'no-store',
                    headers: {
                        'Cache-Control': 'no-cache, no-store, must-revalidate',
                        'Pragma': 'no-cache',
                        'Expires': '0'
                    }
                }).then(response => {
                    if (!response.ok) {
                        throw new Error(`${url}の取得に失敗しました (${response.status})`);
                    }
                    return response.json();
                }),
                new Promise((_, reject) =>
                    setTimeout(() => reject(new Error(`${url}の取得がタイムアウトしました`)), timeout)
                )
            ]);
        };

        const formatFileSize = (bytes) => {
            if (!bytes) return '-';
            return `${(bytes / (1024 * 1024)).toFixed(2)}MB`;
        };

        const formatDate = (dateString) => {
            if (!dateString) return '日付情報なし';
            return new Date(dateString).toLocaleDateString('ja-JP');
        };

        const createBuildCard = (buildInfo, isStable = false) => {
            if (!buildInfo) return '';

            const badgeClass = isStable ? 'bg-success' : 'bg-warning';
            const badgeText = isStable ? '安定版' : '最新ビルド';
            
            // 新しいstable.jsonフォーマットに対応
            const downloadUrl = buildInfo.download_url || buildInfo.assets?.[0]?.browser_download_url;
            const fileName = buildInfo.jar_filename || buildInfo.assets?.[0]?.name || 'hackCraft2.jar';
            const fileSize = formatFileSize(buildInfo.jar_size || buildInfo.assets?.[0]?.size);
            const releaseDate = formatDate(buildInfo.release_date || buildInfo.published_at);
            
            // ビルド番号とバージョンの取得
            let buildNumber = 'N/A';
            let version = 'N/A';
            let paperVersion = buildInfo.paper_version || '';
            
            if (buildInfo.build_number) {
                // stable.jsonフォーマット
                buildNumber = buildInfo.build_number;
                version = buildInfo.version || buildInfo.release_tag || `stable-${buildNumber}`;
            } else if (buildInfo.version) {
                // releases.jsonフォーマット
                version = buildInfo.version;
                // versionからR53の部分を抽出（例: "1.21.5-R53" -> "R53"）
                const match = buildInfo.version.match(/R(\d+)/);
                buildNumber = match ? match[1] : 'N/A';
                
                // versionからPaperバージョンを抽出（例: "1.21.5-R53" -> "1.21.5"）
                const paperMatch = buildInfo.version.match(/^(\d+\.\d+\.\d+)/);
                if (paperMatch && !paperVersion) {
                    paperVersion = paperMatch[1];
                }
            } else if (buildInfo.commit_hash) {
                const hashParts = buildInfo.commit_hash.split('-');
                buildNumber = hashParts[1] || 'N/A';
                version = buildInfo.commit_hash;
            }

            // コミットハッシュの取得
            const commitHash = buildInfo.public_commit_hash || buildInfo.source_commit_hash;
            const releaseTag = buildInfo.release_tag || buildInfo.tag;
            const showReleaseLink = releaseTag && releaseTag.length > 0;

            return `
                <div class="list-group-item">
                    <div class="d-flex w-100 justify-content-between align-items-start">
                        <div class="flex-grow-1">
                            <h6 class="mb-2">
                                ${buildInfo.name || version}
                                <span class="badge ${badgeClass} ms-2">${badgeText}</span>
                            </h6>
                            <div class="mb-2">
                                <p class="mb-1 small text-muted">
                                    <strong>ビルド番号:</strong> ${buildNumber}
                                </p>
                                ${buildInfo.jar_filename ? `<p class="mb-1 small text-muted"><strong>ファイル名:</strong> ${buildInfo.jar_filename}</p>` : ''}
                                ${paperVersion ? `<p class="mb-1 small text-muted"><strong>Paperバージョン:</strong> ${paperVersion}</p>` : ''}
                                ${buildInfo.body ? `<p class="mb-1 small text-muted">${buildInfo.body.split('\n')[0]}</p>` : ''}
                            </div>
                        </div>
                        <div class="text-end ms-3">
                            <small class="text-muted">
                                <strong>ビルド日時:</strong> ${releaseDate}
                            </small>
                        </div>
                    </div>
                    <div class="d-flex justify-content-between align-items-center mt-3">
                        <div>
                            <small class="text-muted"><strong>ファイルサイズ:</strong> ${fileSize}</small>
                        </div>
                        <div>
                            ${showReleaseLink ? `
                                <a href="https://github.com/0x48lab/hackCraft2-public/releases/tag/${releaseTag}" target="_blank" class="btn btn-outline-info btn-sm me-2">
                                    <i class="bi bi-github"></i> 変更履歴
                                </a>
                            ` : ''}
                            <a href="${downloadUrl}" class="btn btn-primary btn-sm" download="${fileName}">
                                <i class="bi bi-download"></i> ダウンロード
                            </a>
                        </div>
                    </div>
                </div>`;
        };

        const loadPastBuilds = async () => {
            try {
                // 現在のstable.jsonからビルド番号を取得
                const stableData = await fetchWithTimeout('stable.json');
                let currentBuildNumber = 0;
                
                // 新しいstable.jsonフォーマットに対応
                if (stableData.build_number) {
                    currentBuildNumber = stableData.build_number;
                } else if (stableData.latest?.commit_hash) {
                    // 古いフォーマット（latestプロパティがある場合）
                    const hashParts = stableData.latest.commit_hash.split('-');
                    currentBuildNumber = parseInt(hashParts[1]) || 0;
                }
                
                const pastBuilds = [];
                
                // stablesディレクトリから過去のビルド情報を取得（現在のビルド番号から逆順で取得）
                for (let i = currentBuildNumber - 1; i >= Math.max(1, currentBuildNumber - 10); i--) {
                    try {
                        const buildData = await fetchWithTimeout(`stables/stable-${i}.json`);
                        if (buildData) {
                            pastBuilds.push(buildData);
                        }
                    } catch (error) {
                        // ファイルが存在しない場合はスキップ
                        console.log(`stable-${i}.json not found`);
                    }
                }
                
                return pastBuilds;
            } catch (error) {
                console.log('過去のビルド情報の取得に失敗:', error);
                return [];
            }
        };

        const updateReleaseInfo = async () => {
            try {
                // stable.jsonから最新ビルド情報を取得
                const stableData = await fetchWithTimeout('stable.json');
                
                // 最新ビルドの表示を更新
                const latestBuildDiv = document.getElementById('latest-build');
                if (stableData.latest) {
                    // 古いフォーマット（latestプロパティがある場合）
                    latestBuildDiv.innerHTML = `
                        <div class="list-group">
                            ${createBuildCard(stableData.latest, false)}
                        </div>`;
                } else if (stableData.build_number) {
                    // 新しいフォーマット（直接プロパティがある場合）
                    latestBuildDiv.innerHTML = `
                        <div class="list-group">
                            ${createBuildCard(stableData, false)}
                        </div>`;
                } else {
                    latestBuildDiv.innerHTML = '<p class="text-muted">最新ビルドの情報が見つかりませんでした。</p>';
                }

                // 安定版リリース情報を表示（releases.jsonのデータを使用）
                const stableReleaseDiv = document.getElementById('stable-release');
                try {
                    const releaseData = await fetchWithTimeout('releases.json');
                    if (releaseData && releaseData.version) {
                        // releases.jsonのデータを安定版として表示
                        stableReleaseDiv.innerHTML = `
                            <div class="list-group">
                                ${createBuildCard(releaseData, true)}
                            </div>`;
                    } else {
                        stableReleaseDiv.innerHTML = '<p class="text-muted">安定版リリースの情報は現在準備中です。</p>';
                    }
                } catch (error) {
                    console.log('releases.jsonが見つかりません:', error);
                    stableReleaseDiv.innerHTML = '<p class="text-muted">安定版リリースの情報は現在準備中です。</p>';
                }

                // 過去のビルド情報を取得
                const pastBuilds = await loadPastBuilds();
                const releaseHistoryDiv = document.getElementById('release-history');
                
                if (pastBuilds.length > 0) {
                    const pastBuildsHtml = pastBuilds
                        .sort((a, b) => {
                            const dateA = new Date(a.release_date || a.published_at);
                            const dateB = new Date(b.release_date || b.published_at);
                            return dateB - dateA;
                        })
                        .slice(0, 10) // 最新10件を表示
                        .map(build => createBuildCard(build, false))
                        .join('');
                    
                    releaseHistoryDiv.innerHTML = `
                        <div class="list-group">
                            ${pastBuildsHtml}
                        </div>`;
                } else {
                    releaseHistoryDiv.innerHTML = '<p class="text-muted">過去のビルド情報は現在準備中です。</p>';
                }

            } catch (error) {
                console.error('リリース情報の更新に失敗しました:', error);
                ['latest-build', 'stable-release', 'release-history'].forEach(id => {
                    const div = document.getElementById(id);
                    if (div) {
                        div.innerHTML = `
                            <div class="alert alert-warning">
                                <i class="bi bi-exclamation-triangle"></i> リリース情報の取得に失敗しました
                            </div>`;
                    }
                });
            }
        };

        // ページ読み込み時にリリース情報を表示
        document.addEventListener('DOMContentLoaded', () => {
            updateReleaseInfo();
            // 5分ごとに自動更新
            setInterval(updateReleaseInfo, 300000);
        });
    </script>
</body>
</html> 